# A/B Test



目标是选择从既定方案中选择更优方案

手段是设计一套科学的实验方法，使得结论可靠

面临的主要问题是：

1. 方案设计
    1. 样本选择的有效性
        1. 无偏性：为了保障小范围的实验结果可以成功推广到全量。（如：假设在1%流量上某功能可以提高10%的点击率，那么在全量上也应该大约提高10%）
        2. 相似性：保证AB实验样本尽量在多维度上的组成相似，这是为了消除协变量的影响（抗干扰），保证AB实验的差异是由测试元素引起的。通常根据样本情况使用某些随机化方法来实现。
        3. 流量规模
            1. 如何计算需要的样本数量规模？https://www.evanmiller.org/ab-testing/sample-size.html
        4. 多重实验的层域管理：当同时进行多个实验时，且流量足以进行如何使得多个实验之间不产生互相干扰
            1. 需要使用hash函数、正交表等手段，来保证各层采用的分流策略是正交的，即各方案的分流是相互独立、互不影响的。
    2. 结合业务预期
        1. 期望的实验时间
        2. 对实验后果的接受程度
    3. 如何克服重叠实验可能带来的流量交叉问题
2. 实验结果分析
    1. 是否置信：结论置信且有显著性差异，才能得出“哪个方案更好”的结论，否则就是数据正常波动导致的差异，AB方案没有显著区别，实验无效。
    2. 效果分析
        1. 哪个方案更好
        2. 哪个ROI更高
        3. 长期看哪个更好
        4. 对不同用户群体有差异吗？本质是看细分维度下的效果，观察流量划分时没有纳入考虑的维度，可能对实验结果有完全不同的表现，如某方案A在老用户群体中表现优于B，但在新用户群体中表现不如B
3. 如何让实验融入到工作流程中



## 方案设计

### 样本选择









## 补充知识点

#### 卡方检验

卡方检验就是统计样本的实际观测值与理论推断值之间的偏离程度，实际观测值与理论推断值之间的偏离程度就决定卡方值的大小，如果卡方值越大，二者偏差程度越大；反之，二者偏差越小；若两个值完全相等时，卡方值就为0，表明理论值完全符合。

### t检验



### 新奇效应

新出现的东西，用户觉得新鲜，导致转化率高，但是过一段时间之后可能会趋于平庸。这种可能需要持续实验一段时间，待数据稳定之后再做评估，才能推测该方案的长期效果



### hash算法

参考 https://www.jianshu.com/p/f9239c9377c5

对象：X
关键码：X.key，对象的关键值，用于作为自变量
散列( hash )函数：h( )
散列地址：h(X.key)

核心原理：通过散列函数决定对象关键值和散列地址之间的关系，实现数据的组织存储和检索。

作用：通过牺牲一定的存储空间（散列空间比节点集合大），来提升检索效率。同时由于不同的节点可能存在相同的关键值、或不同的关键值通过散列函数得到相同的详列地址（冲突现象），需要处理这种情况。

散列函数的选取：

1. 尽可能简单的运算
2. 函数值域必须在散列表范围之内
3. 尽可能让节点均匀分布（提升检索效率、减少冲突）







## 参考文章

腾讯技术工程 《什么是A/B测试？》https://www.zhihu.com/question/20045543